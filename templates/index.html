{% load static %}
<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mgr. Martin Jar√°bek</title>
    <!-- Favicon -->
    <link rel="icon" href="{% static 'images/favicon.png' %}" type="image/x-icon">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body class="bg-gray-100 font-sans">

  <!-- Navigace -->
<nav class="fixed top-0 left-0 w-full bg-white shadow-md z-50 px-6">
    <div class="flex items-center justify-between h-16">
      <!-- Logo -->
      <div class="flex items-center">
        <img src="{% static 'images/logo-light.png' %}" alt="Logo" class="h-12 w-auto">
      </div>
      
  
      <!-- Hamburger tlaƒç√≠tko -->
      <button id="menu-toggle" class="block md:hidden text-3xl focus:outline-none">
        ‚ò∞
      </button>
  
      <!-- Navigaƒçn√≠ odkazy -->
      <ul id="nav-links" class="hidden md:flex space-x-6 text-black text-lg font-semibold mx-auto">
        <li><a href="#about" class="hover:text-blue-500">O mnƒõ</a></li>
        <li><a href="#cv" class="hover:text-blue-500">Moje CV</a></li>
        <li><a href="#projects" class="hover:text-blue-500">Projekty</a></li>
        <li><a href="#leetcode" class="hover:text-blue-500">LeetCode</a></li>
        <li><a href="#contact" class="hover:text-blue-500">Kontakt</a></li>
      </ul>
    </div>
  
        <!-- Skryt√© menu pro mobily -->
        <ul id="mobile-menu" class="md:hidden hidden flex-col space-y-2 mt-2 pb-6 text-black text-lg font-semibold">
        <li><a href="#about" class="block px-2 py-1 hover:text-blue-500">O mnƒõ</a></li>
        <li><a href="#cv" class="block px-2 py-1 hover:text-blue-500">Moje CV</a></li>
        <li><a href="#projects" class="block px-2 py-1 hover:text-blue-500">Projekty</a></li>
        <li><a href="#leetcode" class="block px-2 py-1 hover:text-blue-500">LeetCode</a></li>
        <li><a href="#contact" class="block px-2 py-1 hover:text-blue-500">Kontakt</a></li>
        </ul>
    </nav>
  
    

    <!-- O mnƒõ -->
    <div class="pt-20">
        <section id="about" class="py-16 bg-gray-100">
            <div class="container mx-auto px-6">
                <h2 class="text-3xl font-bold text-center text-gray-800 mb-6">O mnƒõ</h2>
                <div class="max-w-3xl mx-auto text-gray-700 text-lg text-justify">
                    <p class="mb-4">
                        Jmenuji se <strong>Martin Jar√°bek</strong> a po v√≠ce ne≈æ 11 letech ve ≈°kolstv√≠ jsem se rozhodl vydat nov√Ωm smƒõrem ‚Äì st√°t se program√°torem. Jako uƒçitel jsem se vƒõnoval v√Ωuce a rozvoji student≈Ø, co≈æ mi dalo trpƒõlivost, schopnost efektivn√≠ komunikace a dovednost vysvƒõtlovat slo≈æit√© koncepty jednodu≈°e. Tyto zku≈°enosti nyn√≠ vyu≈æ√≠v√°m p≈ôi uƒçen√≠ se nov√Ωm technologi√≠m a pr√°ci na vlastn√≠ch projektech.
                    </p>
                    <p class="mb-4">
                        Od dƒõtstv√≠ mƒõ fascinovaly technologie a ≈ôe≈°en√≠ probl√©m≈Ø. Dodnes si pamatuji, jak jsme s bratrem str√°vili hodiny hled√°n√≠m zp≈Øsobu, jak rozbƒõhnout GTA San Andreas ‚Äì a pr√°vƒõ ten pocit √∫spƒõchu za≈æ√≠v√°m d√≠ky programov√°n√≠ znovu a znovu. Programov√°n√≠ mƒõ natolik pohlcuje, ≈æe p≈ôi nƒõm ztr√°c√≠m pojem o ƒçase, a proto jsem se rozhodl promƒõnit sv≈Øj kon√≠ƒçek v profesi, kter√° mƒõ bude napl≈àovat i dob≈ôe ≈æivit.
                    </p>
                    <h3 class="text-2xl font-semibold text-gray-800 mt-8">Co mƒõ motivuje?</h3>
                    <p class="mb-4">
                        Bav√≠ mƒõ ≈ôe≈°it probl√©my a hledat inovativn√≠ ≈ôe≈°en√≠. Ka≈æd√Ω projekt je pro mƒõ novou v√Ωzvou, kter√° mi pom√°h√° r≈Øst a neust√°le se uƒçit.
                    </p>
                    <h3 class="text-2xl font-semibold text-gray-800 mt-8">Lid√© a komnikace</h3>
                        Vƒõ≈ô√≠m, ≈æe moje siln√© komunikaƒçn√≠ schopnosti a vysok√° m√≠ra empatie jsou v√Ωjimeƒçnou v√Ωhodou v IT svƒõtƒõ, kde tyto dovednosti ƒçasto chyb√≠. D√≠ky sv√© p≈ôedchoz√≠ profesi um√≠m naslouchat, vn√≠mat pot≈ôeby druh√Ωch a efektivnƒõ komunikovat ‚Äì nejen s kolegy, ale i s lidmi mimo obor. Proto bych se v budoucnu r√°d profiloval nejen jako v√Ωvoj√°≈ô, ale i jako IT konzultant, kter√Ω dok√°≈æe propojovat svƒõt technologi√≠ a lid√≠.
                    <p class="mb-4">
                    </p>
                    <h3 class="text-2xl font-semibold text-gray-800 mt-8">Moje dovednosti</h3>
                    <p class="mb-4">
                        M√°m zku≈°enosti s <strong>Pythonem, JS, Django, FastApi, HTML, CSS</strong> a nyn√≠ se uƒç√≠m z√°klady <strong>SQL</strong>. Do budoucna chci sv√© dovednosti d√°le roz≈°i≈ôovat.
                    </p>
                    <h3 class="text-2xl font-semibold text-gray-800 mt-8">Kdy≈æ si chci odpoƒçinout...</h3>
                    <p class="mb-4">
                        V√≠m, jak d≈Øle≈æit√© je udr≈æet si rovnov√°hu mezi prac√≠ a odpoƒçinkem. Ve voln√©m ƒçase se vƒõnuji rodinƒõ, pobytu v p≈ô√≠rodƒõ se sv√Ωm psem, ƒçten√≠ a sportu ‚Äì fotbalu, fitness, tenisu ƒçi plav√°n√≠. Tyto aktivity mi pom√°haj√≠ udr≈æet si ƒçerstvou mysl, inspiraci a motivaci pro nov√© v√Ωzvy.
                    </p>
                    <h3 class="text-2xl font-semibold text-gray-800 mt-8">M≈Øj c√≠l?</h3>
                    <p class="mb-4">
                      St√°t se profesion√°ln√≠m v√Ωvoj√°≈ôem, dƒõlat pr√°ci, kter√° mƒõ bav√≠, a pod√≠let se na projektech s re√°ln√Ωm dopadem ‚Äì ide√°lnƒõ i v roli, kde technologie p≈ôibli≈æuji lidem.
                    </p>
                </div>
            </div>
        </section>
    </div>

    <!-- Sekce CV -->
    <section id="cv" class="py-20 px-4 bg-gray-50 dark:bg-gray-700 transition-colors duration-300">
        <div class="container mx-auto text-center">
            <h2 class="text-3xl font-semibold text-gray-800 dark:text-gray-100">Moje CV</h2>
            
    
            <!-- Tlaƒç√≠tko pro sta≈æen√≠ CV s ikonou -->
            <div class="mt-8 flex flex-col sm:flex-row items-center justify-center space-y-4 sm:space-y-0 sm:space-x-4">
              <a href="{% static 'files/martin-jarabek-cv.pdf' %}" target="_blank" class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-300">
                  <i class="fas fa-eye mr-2"></i> Zobrazit moje CV
                </a>
                <a href="{% static 'files/martin-jarabek-cv.pdf' %}" download class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-300">
                  <i class="fas fa-file-download mr-2"></i> St√°hnout moje CV
                </a>
            </div>
        </div>
    </section>

    <!-- Projekty a GitHub -->
    <section id="projects" class="py-20 px-4 bg-blue-100">
      <div class="container mx-auto text-center">
        <h2 class="text-3xl font-semibold mb-8">Moje Projekty</h2>
        <div class="flex justify-center flex-wrap gap-8 items-stretch">
          <!-- Poƒças√≠ -->
          <div class="bg-white rounded-lg shadow-lg p-6 max-w-md w-full text-left flex flex-col justify-between">
            <h3 class="text-xl font-bold text-gray-800 mb-2">Aplikace na poƒças√≠</h3>
            <p class="text-gray-700 mb-4">
              Webov√° aplikace postaven√° na <strong>FastAPI</strong>, kter√° zobrazuje aktu√°ln√≠ poƒças√≠ s grafy, 5denn√≠ p≈ôedpovƒõƒè, vizualizacemi a mƒõn√≠c√≠m se pozad√≠m podle poƒças√≠. V≈°e responsivn√≠, modern√≠ a napojen√© na <strong>OpenWeatherMap API</strong>.
            </p>
            <!-- OBAL pro tlaƒç√≠tko -->
            <div class="flex justify-center">
              <a href="/weather_app/" target="_blank"
                class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-6 rounded transition duration-300 text-lg flex items-center gap-2">
                üå¶Ô∏è Spustit aplikaci na poƒças√≠
              </a>
            </div>
          </div>
          <!-- HR Chatbot -->
          <div class="bg-white rounded-lg shadow-lg p-6 max-w-md w-full text-left flex flex-col justify-between">
            <h3 class="text-xl font-bold text-gray-800 mb-2">HR Asistent (chatbot)</h3>
            <p class="text-gray-700 mb-4">
              <strong>Inteligentn√≠ chatbot pro personalisty</strong>, kter√Ω um√≠ domlouvat sch≈Øzky, pos√≠lat CV a odpov√≠dat na ot√°zky ohlednƒõ tv√©ho profilu.
            </p>
            <!-- OBAL pro tlaƒç√≠tko -->
            <div class="flex justify-center">
              <button 
                onclick="document.getElementById('mj-chatbot-bubble').click();" 
                class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-6 rounded transition duration-300 text-lg flex items-center gap-2"
              >
                ü§ñ Spustit chat s asistentem
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>

    

    <!-- LeetCode -->
    <section id="leetcode" class="py-20 px-4 bg-gray-50 dark:bg-gray-700 transition-colors duration-300">
        <div class="container mx-auto text-center">
          <h2 class="text-3xl font-semibold text-gray-800 dark:text-gray-100">Moje √∫lohy na LeetCode</h2>
          <!-- Kontejner, do kter√©ho se dynamicky vlo≈æ√≠ jednotliv√© √∫lohy -->
          <div id="leetcode-tasks" class="mt-8 space-y-4"></div>
        </div>
    </section>
  
    
    

    <!-- Kontakt -->
    <section id="contact" class="py-20 px-4 bg-blue-100 dark:bg-blue-900 transition-colors duration-300">
        <div class="container mx-auto text-center">
          <h2 class="text-3xl font-semibold text-gray-800 dark:text-gray-100">Kontakt</h2>
          
          <div class="mt-8 flex flex-wrap justify-center gap-4">
            <!-- Email -->
            <div class="flex flex-col items-center bg-white rounded-lg p-8 shadow-md w-full max-w-xs">
              <a href="mailto:martin.jar91@seznam.cz" class="flex flex-col items-center space-y-2 text-gray-800 dark:text-gray-100 hover:text-blue-500">
                <i class="fas fa-envelope text-4xl"></i>
                <span class="text-lg font-semibold">Email</span>
              </a>
              <div class="mt-2 text-sm text-gray-800 dark:text-gray-100">
                martin.jar91@seznam.cz
              </div>
            </div>
      
            <!-- GitHub -->
            <div class="flex flex-col items-center bg-white rounded-lg p-8 shadow-md w-full max-w-xs">
              <a href="https://github.com/Matty-Jaris" target="_blank" class="flex flex-col items-center space-y-2 text-gray-800 dark:text-gray-100 hover:text-blue-500">
                <i class="fab fa-github text-4xl"></i>
                <span class="text-lg font-semibold">GitHub</span>
              </a>
              <div class="mt-2 text-sm text-gray-800 dark:text-gray-100">
                @Matty-Jaris
              </div>
            </div>
      
            <!-- LinkedIn -->
            <div class="flex flex-col items-center bg-white rounded-lg p-8 shadow-md w-full max-w-xs">
              <a href="https://www.linkedin.com/in/martin-jarabek" target="_blank" class="flex flex-col items-center space-y-2 text-gray-800 dark:text-gray-100 hover:text-blue-500">
                <i class="fab fa-linkedin text-4xl"></i>
                <span class="text-lg font-semibold">LinkedIn</span>
              </a>
              <div class="mt-2 text-sm text-gray-800 dark:text-gray-100">
                martin-jarabek
              </div>
            </div>
          </div>
        </div>
      </section>
    <!-- Naƒçten√≠ dat z extern√≠ho souboru -->
    <script src="{% static 'js/leetcode-data.js' %}"></script>

    <script>
    document.addEventListener("DOMContentLoaded", function () {
        // Hamburger menu toggle
        const toggleButton = document.getElementById('menu-toggle');
        const mobileMenu = document.getElementById('mobile-menu');
        toggleButton.addEventListener('click', () => {
        mobileMenu.classList.toggle('hidden');
        });
        
        // Dynamick√© naƒçten√≠ √∫loh pro LeetCode
        const container = document.getElementById("leetcode-tasks");
        leetcodeTasks.forEach(task => {
        const taskDiv = document.createElement("div");
        taskDiv.className = "bg-white p-1.5 rounded-lg shadow-lg";

        taskDiv.innerHTML = `
            <button class="text-lg font-semibold text-gray-800 dark:text-gray-100 w-full text-left">
            ${task.title}
            </button>
            <div class="mt-2 text-gray-600 dark:text-gray-400 hidden text-left">
            <p>${task.description}</p>
            <div class="flex flex-col sm:flex-row gap-2 mt-4">
                <a href="${task.problemUrl}" target="_blank"
                class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors text-center">
                Zobrazit √∫lohu
                </a>
                <a href="${task.solutionUrl}" target="_blank"
                class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 transition-colors text-center">
                Zobrazit ≈ôe≈°en√≠
                </a>
            </div>
            </div>
        `;

        // Listener pro toggle detailu √∫lohy
        const button = taskDiv.querySelector("button");
        const content = taskDiv.querySelector("div");
        button.addEventListener("click", () => {
            content.classList.toggle("hidden");
        });

        container.appendChild(taskDiv);
        });
        document.querySelectorAll('#mobile-menu a').forEach(link => {
          link.addEventListener('click', () => {
              mobileMenu.classList.add('hidden');
          });
        });
      });
    </script>


    <!-- Chatbot Widget BEGIN -->
<style>
#mj-chatbot-bubble {
  position: fixed;
  bottom: 24px;
  right: 24px;
  z-index: 99999;
  background: #2563eb;
  border-radius: 9999px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.18);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 4px 16px 4px 4px;
  cursor: pointer;
  transition: box-shadow .2s;
}
#mj-chatbot-bubble:hover { box-shadow: 0 4px 18px rgba(37,99,235,0.25);}
#mj-chatbot-bubble img {
  width: 48px;
  height: 48px;
}
#mj-chatbot-bubble span {
  font-size: 1.05rem;
  font-weight: bold;
  color: #fff;
  margin-left: 10px;
  text-shadow: 0 2px 6px rgba(0,0,0,.14);
}
@media (max-width: 600px) {
  #mj-chatbot-bubble { right: 8px; bottom: 8px; padding: 2px 2px 2px 2px; }
  #mj-chatbot-bubble span { display: none !important; }
  #mj-chatbot-bubble img { width: 40px; height: 40px; }
}
#mj-chatbot-header {
  background: #2563eb;
  color: #fff;
  padding: 16px;
  font-size: 1.1em;
  font-weight: bold;
  display: flex;
  align-items: center;
  justify-content: space-between;
}
#mj-chatbot-close {
  cursor: pointer; font-size: 1.4em; font-weight: bold; color: #fff; background: none; border: none;
}
#mj-chatbot-messages {
  flex: 1 1 auto;
  padding: 12px;
  overflow-y: auto;
  background: #f6f8fb;
  font-size: 0.97em;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

#mj-chatbot-window {
  position: fixed;
  bottom: 100px;
  right: 24px;
  width: 360px;
  max-width: 96vw;
  height: 480px;
  max-height: 80vh;
  background: #fff;
  border-radius: 16px;
  box-shadow: 0 2px 24px rgba(37,99,235,0.15);
  display: none;
  flex-direction: column;
  z-index: 100000;
  overflow: hidden;
}
/* @media (max-width: 600px) {
  #mj-chatbot-window {
    width: 98vw;
    height: 90vh;
    right: 1vw;
    bottom: 70px;
    border-radius: 10px;
  }
} */
 @media (max-width: 600px) {
  #mj-chatbot-window {
    width: 100vw !important;
    height: 100vh !important;
    right: 0 !important;
    bottom: 0 !important;
    border-radius: 0 !important;
    max-width: 100vw !important;
    max-height: 100vh !important;
    box-shadow: none !important;
    z-index: 100000;
  }
}


.mj-chatbot-msg-user { align-self: flex-end; background: #2563eb; color: #fff; border-radius: 14px 14px 4px 14px; padding: 8px 13px; max-width: 75%; }
.mj-chatbot-msg-bot { align-self: flex-start; background: #eaefff; color: #222; border-radius: 14px 14px 14px 4px; padding: 8px 13px; max-width: 75%; }
#mj-chatbot-inputbar {
  padding: 10px; background: #fff; border-top: 1px solid #e4e4e4; display: flex; gap: 8px;
}
#mj-chatbot-input {
  flex: 1; border-radius: 8px; border: 1px solid #cfd8dc; padding: 7px 11px;
  outline: none; font-size: 1em; background: #f9fafb;
}
#mj-chatbot-send { background: #2563eb; color: #fff; border: none; border-radius: 8px; padding: 7px 16px; font-weight: bold; cursor: pointer;}
#mj-chatbot-send:disabled { opacity: 0.7; cursor: default;}


/* --- Avatar chatbota u bublin --- */
.mj-chatbot-row { display: flex; align-items: flex-end; }
.mj-chatbot-avatar { width: 32px; height: 32px; border-radius: 50%; margin-right: 8px; border:2px solid #fff; box-shadow:0 2px 4px rgba(37,99,235,0.12);}


</style>

<div id="mj-chatbot-bubble" title="Zeptej se mƒõ!">
  <div class="flex items-center justify-center">
    <img src="{% static 'images/martin-profile.png' %}" alt="Martin Jar√°bek" class="w-12 h-12 rounded-full border-2 border-white shadow-md" />
    <span class="ml-2 font-semibold text-white hidden sm:inline" style="font-size:1.08rem;">Zeptej se mƒõ!</span>
  </div>
</div>

<div id="mj-chatbot-window">
  <div id="mj-chatbot-header">
    <img src="{% static 'images/martin-profile.png' %}" alt="Martin" class="w-8 h-8 rounded-full mr-3 border-2 border-white shadow-sm" />
    Martin ‚Äì HR Asistent
    <button id="mj-chatbot-close" title="Zav≈ô√≠t">&times;</button>
  </div>
  <div id="mj-chatbot-messages"></div>
  <form id="mj-chatbot-inputbar">
    <input id="mj-chatbot-input" type="text" placeholder="Napi≈°te zpr√°vu..." autocomplete="off" required />
    <button id="mj-chatbot-send" type="submit">Odeslat</button>
  </form>
</div>

<script>
const API_URL = "https://telegram-hr-assistant-9i1t.onrender.com/chat"; // m√≠sto /chatbot_api/ask_stream
const $bubble = document.getElementById("mj-chatbot-bubble");
const $window = document.getElementById("mj-chatbot-window");
const $close = document.getElementById("mj-chatbot-close");
const $messages = document.getElementById("mj-chatbot-messages");
const $inputbar = document.getElementById("mj-chatbot-inputbar");
const $input = document.getElementById("mj-chatbot-input");
const $send = document.getElementById("mj-chatbot-send");
let sessionId = "guest-" + Math.random().toString(36).substr(2, 8);

function appendMsg(text, sender, buttons=[]) {
  let rowDiv = document.createElement("div");
  rowDiv.className = (sender === "bot") ? "mj-chatbot-row" : "";
  if(sender === "bot") {
    let avatar = document.createElement("img");
    avatar.src = "/static/images/martin-profile.png";
    avatar.alt = "Martin";
    avatar.className = "mj-chatbot-avatar";
    rowDiv.appendChild(avatar);
  }
  const div = document.createElement("div");
  div.className = sender === "user" ? "mj-chatbot-msg-user" : "mj-chatbot-msg-bot";
  div.innerHTML = text;

  // Tlaƒç√≠tka pod sebe
  if (buttons && buttons.length > 0 && sender === "bot") {
    const btnWrap = document.createElement("div");
    btnWrap.style.marginTop = "8px";
    btnWrap.style.display = "flex";
    btnWrap.style.flexDirection = "column";
    buttons.forEach(label => {
      const btn = document.createElement("button");
      btn.innerText = label;
      btn.className = "bg-blue-500 text-white rounded px-3 py-2 mb-2 hover:bg-blue-600 transition font-semibold text-base";
      btn.onclick = () => {
        $input.value = "";
        sendMsg(label);
        $input.focus();
      };
      btnWrap.appendChild(btn);
    });
    div.appendChild(btnWrap);
  }

  rowDiv.appendChild(div);
  $messages.appendChild(rowDiv);
  $messages.scrollTop = $messages.scrollHeight;
}


function setLoading(isLoading) {
  $send.disabled = isLoading;
  $input.disabled = isLoading;
}

const STREAM_URL = "https://telegram-hr-assistant-9i1t.onrender.com/chat_stream"; // streamovac√≠ endpoint

async function sendMsg(text) {
  appendMsg(text, "user");
  setLoading(true);

  let rowDiv = document.createElement("div");
  rowDiv.className = "mj-chatbot-row";
  let avatar = document.createElement("img");
  avatar.src = "/static/images/martin-profile.png";
  avatar.alt = "Martin";
  avatar.className = "mj-chatbot-avatar";
  rowDiv.appendChild(avatar);

  let streamDiv = document.createElement("div");
  streamDiv.className = "mj-chatbot-msg-bot";
  streamDiv.innerHTML = ""; // zaƒç√°tek pr√°zdn√Ω

  rowDiv.appendChild(streamDiv);
  $messages.appendChild(rowDiv);
  $messages.scrollTop = $messages.scrollHeight;


  try {
    const res = await fetch(STREAM_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        message: text,
        session_id: sessionId
      })
    });

    if (!res.body) throw new Error("Streamov√°n√≠ nen√≠ podporov√°no.");

    const reader = res.body.getReader();
    let decoder = new TextDecoder("utf-8");
    let buf = "";
    let buttons = null;

    while (true) {
      const { value, done } = await reader.read();
      if (done) break;
      buf += decoder.decode(value, { stream: true });

      // Pokud p≈ôijde speci√°ln√≠ blok s tlaƒç√≠tky (n√°≈° form√°t: "\n\n[[[BUTTONS]]]<json>")
      let btnIndex = buf.indexOf("[[[BUTTONS]]]");
      if (btnIndex !== -1) {
        // Oddƒõlit text a tlaƒç√≠tka
        let textPart = buf.substring(0, btnIndex).trim();
        let btnJson = buf.substring(btnIndex + 13).trim();
        buttons = [];
        try {
          buttons = JSON.parse(btnJson);
        } catch (e) {
          // Pokud by se nepoda≈ôilo parse (teoreticky), nevad√≠
        }
        streamDiv.innerHTML = textPart;
        // P≈ôidat tlaƒç√≠tka (stejn√° logika jako v appendMsg)
        if (buttons && buttons.length > 0) {
          const btnWrap = document.createElement("div");
          btnWrap.style.marginTop = "8px";
          btnWrap.style.display = "flex";
          btnWrap.style.flexDirection = "column";
          buttons.forEach(label => {
            const btn = document.createElement("button");
            btn.innerText = label;
            btn.className = "bg-blue-500 text-white rounded px-3 py-2 mb-2 hover:bg-blue-600 transition font-semibold text-base";
            btn.onclick = () => {
              $input.value = "";
              sendMsg(label);
              $input.focus();
            };
            btnWrap.appendChild(btn);
          });
          streamDiv.appendChild(btnWrap);
        }
        buf = ""; // u≈æ nepot≈ôebujeme
        break; // Konec streamov√°n√≠, v≈°e m√°me
      } else {
        // Norm√°ln√≠ pr≈Øbƒõ≈æn√© dopisov√°n√≠ textu
        streamDiv.innerHTML = buf;
        $messages.scrollTop = $messages.scrollHeight;
      }
    }
    // Pokud ≈æ√°dn√© tlaƒç√≠tka nedorazily, appendMsg je u≈æ na streamDiv ‚Äì nic dal≈°√≠ho nen√≠ t≈ôeba
  } catch (e) {
    appendMsg("Omlouv√°m se, nepoda≈ôilo se z√≠skat odpovƒõƒè.", "bot");
  }
  setLoading(false);
  $input.focus();
};
// $bubble.onclick = () => { 
//   $window.style.display = "flex"; 
//   $bubble.style.display = "none"; 
//   $input.focus(); 
// };
// $close.onclick = () => { 
//   $window.style.display = "none"; 
//   $bubble.style.display = "flex"; 
// };
const $backdrop = document.getElementById("mj-chatbot-backdrop");
function isMobile() {
  return window.innerWidth <= 600;
}
function disableBodyScroll() {
  document.body.style.overflow = "hidden";
}
function enableBodyScroll() {
  document.body.style.overflow = "";
}
$bubble.onclick = () => { 
  $window.style.display = "flex"; 
  $bubble.style.display = "none"; 
  if(isMobile()) {
    $backdrop.style.display = "block";
    disableBodyScroll();
    window.scrollTo(0,0);
  }
  $input.focus(); 
};
$close.onclick = () => { 
  $window.style.display = "none"; 
  $bubble.style.display = "flex"; 
  if(isMobile()) {
    $backdrop.style.display = "none";
    enableBodyScroll();
  }
};

$inputbar.onsubmit = e => {
  e.preventDefault();
  const text = $input.value.trim();
  if (!text) return;
  sendMsg(text);
  $input.value = "";
  $input.focus();
};

window.addEventListener("DOMContentLoaded", () => {
  appendMsg(
    "<b>Dobr√Ω den,</b><br>s dovolen√≠m budu odpov√≠dat Martinovo hlasem, tedy v prvn√≠ osobƒõ.<br><br><b>Napi≈°te mi, s ƒç√≠m mohu pomoci.</b> üôÇ",
    "bot"
  );
});
</script>
<!-- Chatbot Widget END -->
 <div id="mj-chatbot-backdrop" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:99998;background:rgba(0,0,0,0.23);"></div>
</body>
</html>